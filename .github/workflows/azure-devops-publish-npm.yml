name: Publish on Azure NPM registry
on:
    push:
        branches:
          - jgrant95-patch-1
jobs:
    publish-to-azure-deveops-npm:
        runs-on: ubuntu-latest
        steps:
        - uses: actions/checkout@v2
        - uses: ponicode/azure-devops-npm-action@1.0.0
          with:
              organisation: jgrant95-2
              registry: https://pkgs.dev.azure.com/jgrant95-2/_packaging/jgrant95-2/npm/registry/
              user: jongrant@corelogic.com
              email: jongrant@corelogic.com
              password: bnRwbXVremJtdXNjMnBkaXBsaXRneWdmdXo1bHdkaGw3czVpNGpvb3liNDZ2NjY2cGZkcQ==
        - run: cp `pwd`/.npmrc ~ # We need the .npmrc file in the $HOME directory
        - name: Install dependencies
          run: npm install
        - name: Test
          run: npm run test
        - name: Publish to Azure
          run: npm publish
